(function(){const p=document.createElement("link").relList;if(p&&p.supports&&p.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const n of r.addedNodes)n.tagName==="LINK"&&n.rel==="modulepreload"&&a(n)}).observe(document,{childList:!0,subtree:!0});function i(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(t){if(t.ep)return;t.ep=!0;const r=i(t);fetch(t.href,r)}})();const l={en:new Map(Object.entries({Backquote:{lower:"`",upper:"~"},Digit1:{lower:"1",upper:"!"},Digit2:{lower:"2",upper:"@"},Digit3:{lower:"3",upper:"#"},Digit4:{lower:"4",upper:"$"},Digit5:{lower:"5",upper:"%"},Digit6:{lower:"6",upper:"^"},Digit7:{lower:"7",upper:"&"},Digit8:{lower:"8",upper:"*"},Digit9:{lower:"9",upper:"("},Digit0:{lower:"0",upper:")"},Minus:{lower:"-",upper:"_"},Equal:{lower:"=",upper:"+"},Tab:{lower:"	",upper:"	"},KeyQ:{lower:"q",upper:"Q"},KeyW:{lower:"w",upper:"W"},KeyE:{lower:"e",upper:"E"},KeyR:{lower:"r",upper:"R"},KeyT:{lower:"t",upper:"T"},KeyY:{lower:"y",upper:"Y"},KeyU:{lower:"u",upper:"U"},KeyI:{lower:"i",upper:"I"},KeyO:{lower:"o",upper:"O"},KeyP:{lower:"p",upper:"P"},BracketLeft:{lower:"[",upper:"{"},BracketRight:{lower:"]",upper:"}"},Backslash:{lower:"\\",upper:"|"},KeyA:{lower:"a",upper:"A"},KeyS:{lower:"s",upper:"S"},KeyD:{lower:"d",upper:"D"},KeyF:{lower:"f",upper:"F"},KeyG:{lower:"g",upper:"G"},KeyH:{lower:"h",upper:"H"},KeyJ:{lower:"j",upper:"J"},KeyK:{lower:"k",upper:"K"},KeyL:{lower:"l",upper:"L"},Semicolon:{lower:";",upper:":"},Quote:{lower:"'",upper:'"'},Enter:{lower:`
`,upper:`
`,breakRow:!0},KeyZ:{lower:"z",upper:"Z"},KeyX:{lower:"x",upper:"X"},KeyC:{lower:"c",upper:"C"},KeyV:{lower:"v",upper:"V"},KeyB:{lower:"b",upper:"B"},KeyN:{lower:"n",upper:"N"},KeyM:{lower:"m",upper:"M"},Comma:{lower:",",upper:"<"},Period:{lower:".",upper:">"},Slash:{lower:"/",upper:"?"},ArrowUp:{lower:"▲",upper:"▲"},Space:{lower:" ",upper:" "},ArrowLeft:{lower:"◄",upper:"◄"},ArrowDown:{lower:"▼",upper:"▼"},ArrowRight:{lower:"►",upper:"►"}})),ru:new Map(Object.entries({Backquote:{lower:"ё",upper:"Ё"},Digit1:{lower:"1",upper:"!"},Digit2:{lower:"2",upper:'"'},Digit3:{lower:"3",upper:"№"},Digit4:{lower:"4",upper:";"},Digit5:{lower:"5",upper:"%"},Digit6:{lower:"6",upper:":"},Digit7:{lower:"7",upper:"?"},Digit8:{lower:"8",upper:"*"},Digit9:{lower:"9",upper:"("},Digit0:{lower:"0",upper:")"},Minus:{lower:"-",upper:"_"},Equal:{lower:"=",upper:"+"},Tab:{lower:"	",upper:"	"},KeyQ:{lower:"й",upper:"Й"},KeyW:{lower:"ц",upper:"Ц"},KeyE:{lower:"у",upper:"У"},KeyR:{lower:"к",upper:"К"},KeyT:{lower:"е",upper:"Е"},KeyY:{lower:"н",upper:"Н"},KeyU:{lower:"г",upper:"Г"},KeyI:{lower:"ш",upper:"Ш"},KeyO:{lower:"щ",upper:"Щ"},KeyP:{lower:"з",upper:"З"},BracketLeft:{lower:"х",upper:"Х"},BracketRight:{lower:"ъ",upper:"Ъ"},Backslash:{lower:"\\",upper:"/"},KeyA:{lower:"ф",upper:"Ф"},KeyS:{lower:"ы",upper:"Ы"},KeyD:{lower:"в",upper:"В"},KeyF:{lower:"а",upper:"А"},KeyG:{lower:"п",upper:"П"},KeyH:{lower:"р",upper:"Р"},KeyJ:{lower:"о",upper:"О"},KeyK:{lower:"л",upper:"Л"},KeyL:{lower:"д",upper:"Д"},Semicolon:{lower:"ж",upper:"Ж"},Quote:{lower:"э",upper:"Э"},Enter:{lower:`
`,upper:`
`,breakRow:!0},KeyZ:{lower:"я",upper:"Я"},KeyX:{lower:"ч",upper:"Ч"},KeyC:{lower:"с",upper:"С"},KeyV:{lower:"м",upper:"М"},KeyB:{lower:"и",upper:"И"},KeyN:{lower:"т",upper:"Т"},KeyM:{lower:"ь",upper:"Ь"},Comma:{lower:"б",upper:"Б"},Period:{lower:"ю",upper:"Ю"},Slash:{lower:".",upper:","},ArrowUp:{lower:"▲",upper:"▲"},Space:{lower:" ",upper:" "},ArrowLeft:{lower:"◄",upper:"◄"},ArrowDown:{lower:"▼",upper:"▼"},ArrowRight:{lower:"►",upper:"►"}})),sys:new Map(Object.entries({Backspace:{pos:14,label:"Backspace",breakRow:!0},Delete:{pos:29,label:"Delete",breakRow:!0},CapsLock:{pos:30,label:"Caps Lock"},ShiftLeft:{pos:43,label:"Shift"},ShiftRight:{pos:55,label:"Shift",breakRow:!0},ControlLeft:{pos:56,label:"Ctrl"},AltLeft:{pos:57,label:"Alt"},AltRight:{pos:59,label:"Alt"},ControlRight:{pos:63,label:"Ctrl"}}))},c={elements:{self:null,keys:[]},props:{layouts:l,targetElem:null},state:{currentLayout:"en",isCapsLocked:!1,pressed:new Set},init(){this.state.currentLayout=localStorage.layout??"en",this.elements.self=document.createElement("div"),this.elements.self.setAttribute("id","keyboard"),document.getElementById("main").append(this.elements.self);const s=e=>{const o=l.en.has(e.code),u=l.sys.has(e.code);!o&&!u&&(e.preventDefault(),e.stopImmediatePropagation())},p=e=>{this.state.pressed.add(e.code)},i=e=>{e.code!=="CapsLock"&&this.state.pressed.delete(e.code)},a=e=>{(e.code==="ShiftLeft"||e.code==="ShiftRight")&&this.showChars(this.visibleCharsSelector())},t=()=>{this.state.pressed.has("ControlLeft")&&this.state.pressed.has("AltLeft")&&(localStorage.layout=localStorage.layout==="en"?"ru":"en",this.state.currentLayout=localStorage.layout,this.showChars(this.visibleCharsSelector()))},r=e=>{e.code==="CapsLock"&&(this.state.isCapsLocked=!this.state.isCapsLocked,document.getElementById(e.code).classList.toggle("key--pressed"),this.state.pressed.has("CapsLock")&&this.state.pressed.delete(e.code),this.showChars(this.visibleCharsSelector()))},n=e=>{if(e.code!=="Backspace"&&e.code!=="Delete")return;e.preventDefault();const o=[...this.props.targetElem.value],u=this.props.targetElem.selectionStart+(e.code==="Delete"?0:-1);o[u]="",this.props.targetElem.value=o.join(""),this.props.targetElem.selectionStart=Math.max(0,u),this.props.targetElem.selectionEnd=Math.max(0,u)};document.addEventListener("keydown",s),document.addEventListener("keyup",s),document.addEventListener("keydown",p),document.addEventListener("keydown",a),document.addEventListener("keyup",i),document.addEventListener("keyup",a),document.addEventListener("keydown",t),document.addEventListener("keydown",r),document.addEventListener("keypress",n),document.addEventListener("keydown",e=>{if(e.code==="CapsLock")return;const o=this.props.layouts[this.state.currentLayout],u=document.getElementById(e.code);u.classList.add("key--pressed"),o.has(e.code)&&(e.preventDefault(),u.click())}),document.addEventListener("keyup",e=>{if(e.code==="CapsLock")return;document.getElementById(e.code).classList.remove("key--pressed")}),this.createKeys(),this.createSysKeys(),this.elements.keys.sort((e,o)=>e.tabIndex-o.tabIndex),this.elements.keys.forEach(e=>{if(this.elements.self.append(e),e.dataset.breakRow){const o=document.createElement("div");o.classList.add("row-breaker"),this.elements.self.append(o)}}),this.showChars(this.visibleCharsSelector())},createKeys(){const s=l.en,p=[...l.sys.values()].map(a=>a.pos);let i=1;s.forEach(({breakRow:a},t)=>{for(;p.indexOf(i)!==-1;)i+=1;const r=document.createElement("div");r.classList.add("key"),r.setAttribute("id",t),r.setAttribute("tabindex",i),r.innerHTML=`
        <span class="char char--en char--lower">${l.en.get(t).lower}</span>
        <span class="char char--en char--upper">${l.en.get(t).upper}</span>
        <span class="char char--ru char--lower">${l.ru.get(t).lower}</span>
        <span class="char char--ru char--upper">${l.ru.get(t).upper}</span>
      `,t==="Enter"&&(r.innerHTML="Enter",r.classList.add("key--wide")),t==="Space"&&r.classList.add("key--space"),t==="Tab"&&(r.innerHTML="Tab",r.classList.add("key--wide")),a&&(r.dataset.breakRow=!0),r.addEventListener("click",()=>{const n=l[this.state.currentLayout].get(t),e=[...this.props.targetElem.value],o=this.props.targetElem.selectionStart;e.splice(o,0,this.isUpper()?n.upper:n.lower),this.props.targetElem.value=e.join(""),this.props.targetElem.selectionStart=o+1,this.props.targetElem.selectionEnd=o+1}),i+=1,this.elements.keys.push(r)})},createSysKeys(){l.sys.forEach(({pos:p,label:i,breakRow:a},t)=>{const r=document.createElement("div");r.classList.add("key"),r.classList.add("key--wide"),r.setAttribute("id",t),r.setAttribute("tabindex",p),r.innerHTML=i,a&&(r.dataset.breakRow=!0),(t==="Backspace"||t==="Delete"||t==="CapsLock")&&r.addEventListener("click",()=>{const n=t==="CapsLock"?"keydown":"keypress",e=new KeyboardEvent(n,{code:t});document.dispatchEvent(e)}),this.elements.keys.push(r)})},bindTo(s){this.props.targetElem=s,s.focus(),s.addEventListener("blur",()=>{s.focus()})},isUpper(){const s=this.state.pressed.has("ShiftLeft")||this.state.pressed.has("ShiftRight");return this.state.isCapsLocked&&!s||!this.state.isCapsLocked&&s},showChars(s){document.querySelectorAll(".char--visible").forEach(p=>{p.classList.remove("char--visible")}),document.querySelectorAll(s).forEach(p=>{p.classList.add("char--visible")})},visibleCharsSelector(){return this.isUpper()&&this.state.currentLayout==="en"?".char--en.char--upper":this.isUpper()&&this.state.currentLayout==="ru"?".char--ru.char--upper":!this.isUpper()&&this.state.currentLayout==="ru"?".char--ru.char--lower":".char--en.char--lower"}};document.querySelector("#app").innerHTML=`
  <header id="header">
    <h1 class="heading">RSS Virtual Keyboard</h1>
  </header>
  <main id="main">
    <textarea id="test-area" name="test-area" rows="8" cols="70">try some buttons</textarea>
  </main>
  <footer id="footer">
    <p>
      Keyboard developed on Ubuntu OS
      <br>
      Press Left(Ctrl + Alt) to switch language to Russian
    </p>
  </footer>
`;document.addEventListener("DOMContentLoaded",()=>{const s=document.getElementById("test-area");c.bindTo(s),c.init()});
